<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- Search view -->
        <record id="warehouse_order_search_view" model="ir.ui.view">
            <field name="name">warehouse.order.search</field>
            <field name="model">warehouse.order</field>
            <field name="arch" type="xml">
                <search string="Tìm kiếm đơn hàng">
                    <field name="name" string="Tên đơn hàng"/>
                    <field name="order_index" string="Mã đơn hàng"/> <!-- Add missing field -->
                    <field name="customer_id" string="Khách hàng"/>
                    <field name="employee_id" string="Người tạo"/>
                    
                    <group expand="0" string="Group By">
                        <filter string="Trạng thái" name="state" context="{'group_by': 'state_order'}"/>
                        <filter string="Khách hàng" name="customer" context="{'group_by': 'customer_id'}"/>
                        <filter string="Người tạo" name="employee" context="{'group_by': 'employee_id'}"/>
                    </group>  
                    <searchpanel>
                        <field name="customer_id" string="Khách hàng" icon="fa-address-card" enable_counters="1" 
                            options="{'always_loaded': True}"/>
                    </searchpanel>
                </search>
            </field>
        </record>
        <!-- From view 1-->
        <record id="warehouse_order_form_view" model="ir.ui.view">
            <field name="name">warehouse.order.form</field>
            <field name="model">warehouse.order</field>
            <field name="arch" type="xml">
                <form string="Đơn hàng">
                    <header>
                    </header>
                    <sheet style="max-width: 100%; margin-left: auto; margin-right: auto;" invisible="id == False">
                        <field name="state_order" invisible="1"/> 

                        <div id="o_work_employee_container2" class="d-lg-flex" style="width: 100%;">
                            <div id="o_work_employee_main2" class="flex-grow-1 pe-lg-2">             
                                <div class="d-flex align-items-center">
                                    <div class="flex-grow-1" style="display: flex; align-items: center;">
                                        <span style="font-size: 20px; font-weight: bold;height: 28px; line-height: 28px; margin-right: 5px; color: #003366">Đơn hàng:</span>
                                        <field name="name" placeholder="tiêu đề" style="font-size: 20px; height: 28px; line-height: 28px;font-weight: bold; min-width: 200px; flex: 1; color: #003366"/>
                                    </div>
                                    <div class="ms-3">
                                        <field name="priority"  readonly="1" widget="badge" 
                                            decoration-danger="priority == '2'" 
                                            decoration-warning="priority == '1'"/>
                                    </div>
                                </div>
                                <group>
                                    <div style="display: flex; align-items: center; gap: 5px; width: 100%; margin: 0;" colspan="2" invisible="state_order in ['refuse','cancelled']" >
                                        <span style="font-size: 16px; color: #666666;font-weight: bold; height: 28px; line-height: 28px;
                                             white-space: nowrap;">Thời hạn phê duyệt:</span>
                                        <field name="expected_date" widget="date" readonly="id != False" placeholder="Chọn thời hạn" style="font-weight: bold; font-size: 16px; 
                                            height: 28px;  line-height: 28px;"/>
                                        <span style="font-size: 16px; color: #666666;font-weight: bold; height: 28px; line-height: 28px; white-space: nowrap;">Còn lại:</span>
                                        <field name="remaining_time" readonly="id != False" 
                                            style="font-weight: bold; color: red; font-size: 16px; height: 28px;  line-height: 28px;"
                                                decoration-danger="remaining_time == 'Quá hạn'"
                                                decoration-success="remaining_time == 'Hoàn thành'"
                                                decoration-warning="remaining_time == 'Hoàn thành muộn'"/>
                                    </div>
                                    <div style="display: flex; align-items: center;" colspan="2">
                                        <span style="font-size: 16px; color: #666666;font-weight: bold; margin: 5px;height: 28px; line-height: 28px; ">Trạng thái : </span>
                                        <span invisible="state_order != 'department_approval'" style="font-weight: bold;height: 28px; line-height: 28px; color: #6c757d; font-size: 16px; "> Phòng ban duyệt </span>
                                        <span invisible="state_order != 'manager_approval'" style="font-weight: bold;height: 28px; line-height: 28px; color: orange; font-size: 16px;"> Chờ quản lý duyệt </span>
                                        <span invisible="state_order != 'validate'" style="font-weight: bold;height: 28px; line-height: 28px; color: green; font-size: 16px; "> Đã duyệt </span>
                                        <span invisible="state_order != 'refuse'" style="font-weight: bold;height: 28px; line-height: 28px; color: red; font-size: 16px; "> Đã từ chối </span>
                                        <span invisible="state_order != 'cancelled'" style="font-weight: bold;height: 28px; line-height: 28px; color: red; font-size: 16px; "> Đã hủy </span>
                                    </div>
                                </group>
                                        <field name="show_cancel_button" invisible="1"/>
                                        <field name="show_manager_approval_button" invisible="1"/>
                                        <field name="show_department_approval_button" invisible="1"/>
                                        <field name="show_refuse_button" invisible="1"/>
                                        <div class="button-container">
                                            <button name="action_cancel" string="Hủy"  type="object" 
                                                confirm="Bạn có chắc chắn muốn hủy đề nghị này không?"
                                                invisible="not show_cancel_button"
                                                class="custom-cancel-button btn btn-danger"
                                                style=" max-width: 80px;">
                                                <i class="fa fa-check"/>
                                                Hủy đề nghị
                                            </button>
                                            <button name="action_manager_order" string="Phê duyệt"  type="object" 
                                                invisible="not show_manager_approval_button"
                                                class="custom-approval-button"
                                                style=" max-width: 80px;">
                                                <i class="fa fa-check"/>
                                                Phê duyệt
                                            </button>
                                            <button name="action_validate" string="Phê duyệt" type="object"
                                               invisible="not show_department_approval_button"
                                                class="custom-approval-button"
                                                style=" max-width: 80px;">
                                                <i class="fa fa-check"/>
                                                Phê duyệt
                                            </button>
                                            <button name="action_refuse" string="Từ chối" type="object"
                                                confirm="Bạn có chắc chắn muốn từ chối đề nghị này?"
                                                invisible="not show_refuse_button"
                                                class="custom-refuse-button"
                                                style=" max-width: 80px;">
                                                <i class="fa fa-times"/>
                                                Từ chối
                                            </button>
                                        </div>
                                        
                                    <div class="oe_button_box" name="button_box"/>
                                <notebook>
                                    <page name="general_information"  string="THÔNG TIN ĐƠN HÀNG" class="fw-bold" >
                                        <div style="display: flex; gap: 20px;">
                                            <!-- Cột trái: Thông tin đơn hàng -->
                                            <div style="flex: 1; background-color:rgb(255, 255, 255); padding: 10px; border-radius: 6px;">
                                                <div class="o_form_group_row" style="display: flex; align-items: center; flex-wrap: nowrap; width: 100%;">
                                                    <span class="fa fa-user-circle-o" style="margin-right: 10px; color: #007bff; font-size: 18px;"></span>
                                                    <span class="o_form_label" style="margin-right: 10px;height: 26px; line-height: 26px; font-weight: bold; min-width: 100px;">Người đề nghị:</span> 
                                                    <field name="employee_id" widget="many2one_avatar_user" readonly="1" placeholder="Chọn người đề nghị" 
                                                        style="min-width: 200px;height: 26px; line-height: 26px; padding: 2px; font-weight: bold;"/>
                                                </div>   
                                                <div class="o_form_group_row" style="display: flex; align-items: center; flex-wrap: nowrap; width: 100%;">
                                                    <span class="fa fa-barcode" style="margin-right: 10px; color: #28a745; font-size: 18px;"></span>
                                                    <span class="o_form_label" style="margin-right: 10px; height: 26px; line-height: 26px; font-weight: bold; min-width: 100px;">Mã đơn hàng:</span>
                                                    <field name="order_index" placeholder="Nhập mã đơn hàng..." style="min-width: 100px; font-weight: bold;height: 26px; line-height: 26px;padding: 2px;"/>
                                                </div>
                                                <div class="o_form_group_row" style="display: flex; align-items: center; flex-wrap: nowrap; width: 100%;">
                                                    <span class="fa fa-address-card" style="margin-right: 10px; color:rgb(83, 120, 130); font-size: 18px;"></span>
                                                    <span class="o_form_label" style="margin-right: 10px;height: 26px; line-height: 26px; font-weight: bold; min-width: 100px;">Khách hàng :</span>
                                                    <field name="customer_id"  style="min-width: 100px; font-weight: bold;height: 26px; line-height: 26px; padding: 2px;"/>
                                                </div>
                                                <div class="o_form_group_row" style="display: flex; align-items: center; flex-wrap: nowrap; width: 100%;">
                                                    <span class="fa fa-calendar" style="margin-right: 10px; color: #ffc107; font-size: 18px;"></span>
                                                    <span class="o_form_label" style="margin-right: 10px;height: 26px; line-height: 26px; font-weight: bold; min-width: 100px;">Ngày đặt hàng:</span>
                                                    <field name="order_date" widget="date"  placeholder="Chọn ngày đặt hàng" style="min-width: 100px;height: 26px; line-height: 26px;padding: 2px;"/>
                                                </div>
                                                <div class="o_form_group_row" style="display: flex; align-items: center; flex-wrap: nowrap; width: 100%;">
                                                    <span class="fa fa-calendar-check-o" style="margin-right: 10px; color: #dc3545; font-size: 18px;"></span>
                                                    <span class="o_form_label" style="margin-right: 10px; font-weight: bold; height: 26px; line-height: 26px;min-width: 100px;">Ngày dự kiến hoàn thành:</span>
                                                    <field name="expected_date" widget="date"  placeholder="Chọn thời gian dự kiến hoàn thành" style="min-width: 100px;height: 26px; line-height: 26px;padding: 2px;"/>
                                                </div> 
                                            </div>
                                            <!-- Cột phải: File đính kèm -->
                                            <div style="flex: 1; background-color:rgb(255, 255, 255); padding: 10px; border-radius: 6px;">
                                                <h3 style="font-size: 16px; font-weight: bold;">
                                                    <span class="fa fa-industry" style="color: gray; margin-right: 5px;"></span>File đính kèm
                                                </h3>
                                                <field name="attachment_ids" widget="many2many_binary" />
                                            </div>
                                        </div>                           
                                    </page>
                                </notebook>
                            </div>
                            <div id="o_employee_right" class="col-lg-4 px-0 ps-lg-3 pe-lg-3" style="background-color: #fbfcff;">
                                <separator string="người phê duyệt tiếp theo >>>" style="color: #6c48c5;" />
                                <field name="approver_avatar_name_job" />
             
                            <separator string="Cấp phê duyệt"  style="color: #6c48c5;" />
           
                            <div class="o_form_group_row" style="display: flex; flex-direction: column; margin-bottom: 15px;">
                                <span class="o_form_label" style="font-weight: bold; margin-bottom: 5px;">Quản lý phê duyệt:</span>
                                <field name="manager_ids" widget="many2many_avatar_user" 
                                    placeholder="Quản lý được tạo tự động" 
                                    style="width: 100%;"/>
                            </div>

                            <div class="o_form_group_row" style="display: flex; flex-direction: column; margin-bottom: 15px;" >
                                <span class="o_form_label" style="font-weight: bold; margin-bottom: 5px;">Phòng ban phê duyệt:</span>
                                <field name="department_approval_id" widget="many2many_avatar_user" 
                                    placeholder="Người duyệt được tạo tự động" 
                                    style="width: 100%;"/>
                            </div>

                                <separator string="người theo dõi"  style="color: #6c48c5;" />
                                <div class="o_follower_wrapper" style="display: flex; align-items: center;">
                                    <field name="follow_ids" widget="many2many_avatar_user" 
                                        placeholder="Người theo dõi được tạo tự động" 
                                        class="highlight_follower"/>
                                    <span class="fa fa-plus-circle" style="font-size: 25px; color: #28a745; margin-left: 5px;"
                                        title="Thêm người theo dõi"  ></span>
                                </div>       
                                <hr/>
                            </div>
                        </div>
                        <div style="background-color: rgb(237, 237, 237);width: 100%; padding: 0 15px;  border-radius: 6px;">
                            <div style="width: 100%;">
                                <!-- Tiêu đề nằm góc trái phía trên bảng, cùng container với bảng -->
                                <notebook>
                                    <page string="MÃ HÀNG" invisible="state_order != 'validate'" class="fw-bold">
                                        <!-- Thanh tiêu đề và tìm kiếm -->
                                        <div class="d-flex align-items-center justify-content-between" style="margin-bottom: 10px;">     
                                            <!-- BÊN TRÁI: Tiêu đề -->
                                            <div style="flex: 1; font-weight: bold; font-size: 14px;">
                                                <span class="fa fa-list-alt" style="padding-right: 6px; color: gray;"/>DANH SÁCH MÃ HÀNG
                                            </div>
                                            <!-- Ở GIỮA: Ô tìm kiếm -->
                                            <div style="flex: 1; display: flex; justify-content: center;">
                                                <div style="width: 500px; display: flex; justify-content: center; align-items: center; height: 38px; border: 1px solid #ced4da; border-radius: 3px; padding: 4px 8px;">
                                                    <field name="product_search_active" invisible="1"/>
                                                    <field name="product_search_text" placeholder="Tìm kiếm mã hàng..." style="flex: 1; border: none; outline: none;"/>
                                                    <button type="object" name="action_search_product" class="btn btn-link p-0" title="Search" invisible="product_search_active == True">
                                                        <span class="fa fa-search" style="color: #6c757d;"/>
                                                    </button>
                                                    <button type="object" name="clear_search_product" class="btn btn-link p-0" title="Clear" invisible="product_search_active == False">
                                                        <span class="fa fa-times" style="color: #6c757d;"/>
                                                    </button>
                                                </div>
                                            </div>
                                            <!-- BÊN PHẢI: Các nút -->
                                            <div style="flex: 1; display: flex; gap: 10px; align-items: center; justify-content: flex-end;">
                                                <!-- Nút Import mã hàng-->
                                                <button type="object" name="action_import_product" class="btn btn-outline-success btn-sm" title="Import"
                                                        style="border-radius: 4px;">
                                                    <span class="fa fa-download" style="margin-right: 5px;"></span>
                                                    <span style="color: #28a745;">Import mã hàng</span>
                                                </button>

                                                <!-- Nút Import vật tư -->
                                                <button type="object" name="action_import_material" class="btn btn-outline-success btn-sm" title="Import"
                                                        style="border-radius: 4px;">
                                                    <span class="fa fa-download" style="margin-right: 5px;"></span>
                                                    <span style="color: #28a745;">Import vật tư</span>
                                                </button>
                                                <!-- Nút Tuỳ chọn -->
                                                <div class="dropdown">
                                                    <button name="button_dummy_product" type="object" class="btn btn-light fa fa-ellipsis-v"
                                                            data-bs-toggle="dropdown" aria-expanded="false" title="Tuỳ chọn"/>
                                                    <div class="dropdown-menu" role="menu">
                                                        <div class="dropdown-divider"/>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div style="max-width: 100%; height: 500px; overflow-y: auto; padding: 0 12px;">
                                            <field name="product_code_ids" string=" ">
                                                <tree string="Mã hàng" class="o_hide_open_product" create="false" limit="20">
                                                    <field name="name" string="MÃ HÀNG"/>
                                                    <field name="employee_id" string="NGƯỜI TẠO" widget="many2one_avatar_user" />
                                                    <field name="date_create" string="Ngày tạo" optional="hide"/>
                                                    <field name="active" widget="boolean_toggle" string="TRẠNG THÁI"/>
                                                    <button name="open_product_code_form" type="object" string="" class="fa fa-external-link" 
                                                        title="Open in new tab"/>
                                                </tree>
                                            </field>
                                        </div>
                                    </page>
                                    <page string="TỔNG VẬT TƯ" invisible="state_order != 'validate'" class="fw-bold">
                                        <!--Thanh tiêu đề và tìm kiếm -->
                                        <div class="d-flex align-items-center justify-content-between" style="margin-bottom: 10px;">
                                                
                                            <!-- BÊN TRÁI: Tiêu đề -->
                                            <div style="flex: 1; font-weight: bold; font-size: 14px;">
                                                <span class="fa fa-list-alt" style="padding-right: 6px; color: gray;"/>Danh sách tổng vật tư đơn hàng
                                            </div>

                                            <!-- Ở GIỮA: Ô tìm kiếm -->
                                            <div style="flex: 1; display: flex; justify-content: center;">
                                                <div style="width: 500px; display: flex; justify-content: center; align-items: center; height: 38px; border: 1px solid #ced4da; border-radius: 3px; padding: 4px 8px;">
                                                    <field name="material_search_active" invisible="1"/>
                                                    <field name="material_search_text" placeholder="Tìm kiếm vật tư..." style="flex: 1; border: none; outline: none;"/>
                                                    <button type="object" name="action_search_material" class="btn btn-link p-0" title="Search" invisible="material_search_active == True">
                                                        <span class="fa fa-search" style="color: #6c757d;"/>
                                                    </button>
                                                    <button type="object" name="clear_search_material" class="btn btn-link p-0" title="Clear" invisible="material_search_active == False">
                                                        <span class="fa fa-times" style="color: #6c757d;"/>
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- BÊN PHẢI: Các nút -->
                                            <div style="flex: 1; display: flex; gap: 10px; align-items: center; justify-content: flex-end;">
                                                <!--Cập nhật vật tư -->
                                                <button type="object" name="action_compute_grouped_materials" class="btn btn-outline-warning btn-sm"
                                                        title="Cập nhật vật tư" style="border-radius: 4px;">
                                                    <span class="fa fa-refresh" style="margin-right: 5px;"></span>
                                                    <span style="color: #ff9800;">Cập nhật vật tư</span>
                                                </button>

                                                <!-- Nút Export -->
                                                <button type="object" name="action_export_sum_material" class="btn btn-outline-primary btn-sm" title="Export"
                                                        style="border-radius: 4px;">
                                                    <span class="fa fa-upload" style="margin-right: 5px;"></span>
                                                    <span style="color: #007bff;">Export</span>
                                                </button>

                                                    <!-- Nút Tuỳ chọn -->
                                                <div class="dropdown">
                                                    <button name="button_dummy_material" type="object" class="btn btn-light fa fa-ellipsis-v"
                                                            data-bs-toggle="dropdown" aria-expanded="false" title="Tuỳ chọn"/>
                                                    <div class="dropdown-menu" role="menu">
                                                        <div class="dropdown-divider"/>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                        <div style="overflow-x: auto; max-width: 100%; height: 500px; overflow-y: auto;">
                                            <!-- Tree view danh sách vật tư -->
                                            <field name="aggregated_material_ids" string=" ">
                                                <tree string="Định mức" class="o_progarm_list_view table" editable="bottom" create="false" limit="20">
                                                <!-- Thông tin vị trí và phân loại -->
                                                    <field name="mtr_type" string="PHÂN LOẠI"/>
                                                    
                                                    <!-- Mã và thông tin cơ bản -->
                                                    <field name="mtr_no" string="MÃ ITEM"/>
                                                    <field name="mtr_code" string="CODE NHÀ CUNG CẤP"/>
                                                    <field name="mtr_name" string="TÊN VẬT TƯ"/>
                                                    
                                                    <!-- Thông số kỹ thuật -->
                                                    <field name="dimension" string="KÍCH THƯỚC"/>
                                                    <field name="color_item" string="KÍ HIỆU"/>
                                                    <field name="color_name" string="MÀU SẮC"/>
                                                    <!-- Số lượng ước tính-->
                                                    <field name="est_qty" string="SL ƯỚC TÍNH" />
                                                    <field name="act_qty" string="SL THỰC TẾ" />                   
                                                    <!-- Định mức và đơn vị -->
                                                    <field name="rate" string="ĐƠN VỊ TÍNH"/>
                                                    <field name="price" string="GIÁ" sum="Total"/>
                                                    
                                                    <!-- Thông tin nhà cung cấp -->
                                                    <field name="supplier" string="NHÀ CUNG CẤP"/>
                                                    <field name="country" string="NƯỚC XUẤT XỨ"/>
                                                    
                                                    <!-- Thông tin giá -->
                                                    <field name="cif_price" string="GIÁ CIF" sum="Tổng CIF" />
                                                    <field name="fob_price" string="GIÁ FOB" sum="Tổng FOB"/>
                                                    <field name="exwork_price" string="GIÁ EXW" sum="Tổng EXW"/>
                                                    <field name="total" string="TỔNG" sum="Total Amount"/>
                                                </tree>
                                            </field>
                                        </div>
                                    </page>
                                    <page string="DANH SÁCH PO" invisible="state_order != 'validate'" class="fw-bold">
                                       <div class="d-flex align-items-center justify-content-between" style="margin-bottom: 10px;">     
                                            <!-- BÊN TRÁI: Tiêu đề -->
                                            <div style="flex: 1; font-weight: bold; font-size: 14px;">
                                                <span class="fa fa-list-alt" style="padding-right: 6px; color: gray;"/>DANH SÁCH PO
                                            </div>
                                            <!-- Ở GIỮA: Ô tìm kiếm -->
                                            <div style="flex: 1; display: flex; justify-content: center;">
                                                <div style="width: 500px; display: flex; justify-content: center; align-items: center; height: 38px; border: 1px solid #ced4da; border-radius: 3px; padding: 4px 8px;">
                                                    <field name="product_search_active" invisible="1"/>
                                                    <field name="product_search_text" placeholder="Tìm kiếm mã hàng..." style="flex: 1; border: none; outline: none;"/>
                                                    <button type="object" name="action_search_product" class="btn btn-link p-0" title="Search" invisible="product_search_active == True">
                                                        <span class="fa fa-search" style="color: #6c757d;"/>
                                                    </button>
                                                    <button type="object" name="clear_search_product" class="btn btn-link p-0" title="Clear" invisible="product_search_active == False">
                                                        <span class="fa fa-times" style="color: #6c757d;"/>
                                                    </button>
                                                </div>
                                            </div>
                                            <!-- BÊN PHẢI: Các nút -->
                                            <div style="flex: 1; display: flex; gap: 10px; align-items: center; justify-content: flex-end;">
                                                <!-- Nút Import mã hàng-->
                                                <button type="object" name="action_create_po_from_aggregated_materials" class="btn btn-outline-success btn-sm" title="Import"
                                                        style="border-radius: 4px;">
                                                    <span class="fa fa-plus-circle" style="margin-right: 5px;"></span>
                                                    <span style="color: #28a745;">Tạo PO</span>
                                                </button>

                                                <!-- Nút Export -->
                                                <button type="object" name="action_export_po_material" class="btn btn-outline-primary btn-sm" title="Export"
                                                        style="border-radius: 4px;">
                                                    <span class="fa fa-upload" style="margin-right: 5px;"></span>
                                                    <span style="color: #007bff;">Export PO</span>
                                                </button>
                                                <!-- Nút Tuỳ chọn -->
                                                <div class="dropdown">
                                                    <button name="button_dummy_product" type="object" class="btn btn-light fa fa-ellipsis-v"
                                                            data-bs-toggle="dropdown" aria-expanded="false" title="Tuỳ chọn"/>
                                                    <div class="dropdown-menu" role="menu">
                                                        <div class="dropdown-divider"/>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div style="max-width: 100%; height: 500px; overflow-y: auto; padding: 0 12px;">
                                            <field name="po_ids" string=" ">
                                                <tree string="Mã po" class="o_hide_open_po" create="false" limit="20">
                                                    <field name="name" string ="MÃ PO"/>
                                                    <field name="order_id" string ="ĐƠN HÀNG"/>
                                                    <field name="supplier_id" string ="NHÀ CUNG CẤP"/>
                                                    <field name="employee_id" string ="NGƯỜI TẠO" widget="many2one_avatar_user"/>
                                                    <field name="date_create" string ="NGÀY TẠO"/>
                                                    <button name="open_po_form_view" type="object" string="" class="fa fa-external-link" 
                                                        title="Open in new tab"/>
                                                </tree>
                                            </field>
                                        </div>
                                    </page>
                                    <page string="ĐỊNH MỨC ĐƠN HÀNG" invisible="state_order != 'validate'" class="fw-bold">
                                            <!-- Thanh tiêu đề và tìm kiếm -->
                                            <div class="d-flex align-items-center justify-content-between" style="margin-bottom: 10px;">     
                                                <!-- BÊN TRÁI: Tiêu đề -->
                                                <div style="flex: 1; font-weight: bold; font-size: 16px;">
                                                    <span class="fa fa-list-alt" style="padding-right: 6px; color: gray;"/>DANH SÁCH VẬT TƯ ĐỊNH MỨC ĐƠN HÀNG
                                                </div>
                                            </div>
                                    </page>                                    
                                </notebook>
                            </div>
                        </div>                     
                        <div style="padding-bottom:25px;"/>

                        <!-- Chatter log lịch sử và chỉ có quyền Admin hệ thống mới được xem -->
                        <div class="oe_chatter" invisible="1">
                            <field name="message_follower_ids" widget="mail_followers"/>
                            <field name="message_ids" widget="mail_thread"/>
                        </div>  
                    </sheet>

                    <sheet invisible="id" style="max-width: 60%; margin-left: auto; margin-right: auto;">
                        <h1 style="text-align: center; color: #003366;">TẠO ĐƠN HÀNG MỚI</h1>
                        <hr/>

                        <group>
                            <div style="display: flex; flex-direction: column;" colspan="2">
                                <p style="font-size: 16px; color: #006699;margin: 2px 8px;">
                                - Áp dụng cho các trường hợp cần phê duyệt trước khi thực hiện.</p>
                                <p style="font-size: 16px; color: #006699;margin: 2px 8px;">
                                - Cần đảm bảo đầy đủ thông tin và giấy tờ liên quan để giúp quá trình phê duyệt nhanh chóng.</p>
                            </div>
                        </group>
                        <hr/>

                        <div class="oe_title">                      
                            <div class="d-flex align-items-center justify-content-between" style="width: 100%;">
                                <div class="flex-grow-1">
                                    <label for="name" string="TIÊU ĐỀ" class="oe_edit_only o_list_field_name"/>
                                    <h1>
                                        <field name="name" placeholder="Tiêu đề" />
                                    </h1>
                                </div>
                                <div style="margin-left: auto; padding: 8px;">
                                    <field name="priority" widget="priority" placeholder="Mức độ ưu tiên" style="font-size: 20px;" />
                                    <field name="priority" widget="badge" 
                                        decoration-danger="priority == '2'" 
                                        decoration-warning="priority == '1'"
                                        style="font-size: 16px; padding: 6px 12px;"/>
                                </div>
                            </div>
                        </div>
                        <div class="oe_button_box" name="button_box"/>

                        <notebook>
                            <page name="general_information" string="THÔNG TIN CHUNG" class="fw-bold">
                                <group col="2">
                                    <group>
                                        <field name="employee_id" widget="many2one_avatar_user" readonly="1"/>
                                        <field name="follow_ids" widget="many2many_avatar_user" style="border: 1px solid #ced4da; padding-left: 2px;"/>
                                    </group>
                                    <group>
                                        <field name="manager_ids" widget="many2many_avatar_user" style="border: 1px solid #ced4da; padding-left: 2px;"/>
                                        <field name="department_approval_id" widget="many2many_avatar_user" style="border: 1px solid #ced4da; padding-left: 2px;"/>
                                    </group>
                                </group>
                            </page>
                        </notebook>
                        <notebook>
                            <page name="add_information" string="NỘI DUNG ĐƠN HÀNG"     class="fw-bold">
                                    <group>
                                        <field name="order_index" placeholder="Mã đơn hàng ...." style="border: 1px solid #ced4da; padding-left: 2px;"/>
                                        <field name="order_date" widget="date" placeholder="Ngày đặt hàng" style="border: 1px solid #ced4da; padding-left: 2px;"
                                            options="{'datepicker': {'format': 'dd/mm/yyyy'}}"/>
                                        <field name="expected_date" widget="date" placeholder="Ngày dự kiến hoàn thành" style="border: 1px solid #ced4da; padding-left: 2px;"
                                            options="{'datepicker': {'format': 'dd/mm/yyyy'}}"/>
                                        <field name="customer_id" placeholder="Khách hàng" style="border: 1px solid #ced4da; padding-left: 2px;"/>
                                    </group>
                                <group>
                                    <field name="description" placeholder="Mô tả chi tiết đơn hàng" style="width: 100%; border: 1px solid #ced4da; padding-left: 2px;"/>
                                </group>
                            </page>
                        </notebook>
                        <notebook>
                            <page string="FILE ĐÍNH KÈM" class="fw-bold">
                                <field name="attachment_ids" widget="many2many_binary"/>
                            </page>
                        </notebook>
                        <button name="save" special="save" string="Lưu" type="object" class="btn-primary"/>
                        <button  string="Hủy" special="cancel" type="object" class="btn-secondary"/>
                    </sheet>
                    <footer>
                        <button name="save" special="save" string="Lưu" type="object" class="btn-primary"/>
                        <button  string="Hủy" special="cancel" type="object" class="btn-secondary"/>
                    </footer>
                </form>
            </field>
        </record>
        
        <!-- Tree View -->
        <record id="warehouse_order_tree_view" model="ir.ui.view">
            <field name="name">warehouse.order.tree</field>
            <field name="model">warehouse.order</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="status_display" string="TÊN ĐƠN HÀNG" widget="html"/>
                    <field name="employee_id" string="NGƯỜI ĐỀ NGHỊ" widget="many2one_avatar_user"/>
                    <field name="order_index" string="MÃ ĐƠN HÀNG"/>
                    <field name="customer_id" string="KHÁCH HÀNG"/>
                    <field name="order_date" string="NGÀY ĐẶT" optional="hide"/>
                    <field name="expected_date" string="DỰ KIẾN HOÀN THÀNH" optional="hide"/>
                    <field name="approver_avatar_name_job" string="NGƯỜI PHÊ DUYỆT TIẾP THEO" widget="html"/>   
                    <field name="complete_date" string="NGÀY HOÀN THÀNH" optional="hide"/>
                    <field name="state_order" string="TRẠNG THÁI" widget="badge"/>
                </tree>
            </field>
        </record>

        <!-- Action Window -->
        <record id="action_warehouse_order" model="ir.actions.act_window">
            <field name="name">Tạo đơn hàng</field>
            <field name="res_model">warehouse.order</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="warehouse_order_search_view"/>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Tạo đơn hàng mới
                </p>
            </field>
        </record>
    </data>
</odoo>

