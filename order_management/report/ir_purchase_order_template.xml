<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="report_material_invoice_template">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="o">
        <t t-call="web.basic_layout">
          <div class="page" style="margin: 0px; padding: 0 ; font-family: Arial, sans-serif; position: relative;">
            <!-- HEADER -->
            <table style="width:100%; border:1px solid rgba(0, 0, 0, 0.5); border-collapse: collapse;">
              <tr>
                <td style="width:30%; text-align:center; border-right:1px solid rgba(0, 0, 0, 0.5); vertical-align:middle;">
                  <h1 style="margin:10px; font-weight:700; font-size: 20px;">PURCHASE ORDER</h1>
                </td>
                <td style="width:70%; padding:5px; vertical-align:middle; background-color:#f2f2f2">
                  <table style="width:100%; border:none; ">
                    <tr style="border:none;">
                      <td style="width:20%; text-align:left; vertical-align:middle; border:none;">
                        <img t-if="o.company_id.logo"
                            t-att-src="'data:image/png;base64,%s' % o.company_id.logo.decode('utf-8')"
                            style="max-height:60px;"/>
                      </td>
                      <td style="width:80%; text-align:left; vertical-align:middle; border:none; padding-left:10px;">
                        <h1 style="font-weight:700; font-size:20px; margin:0; line-height:22px;">
                          <span t-esc="o.company_id.name"/>
                        </h1>
                        <p style="font-size:13px; margin:0; line-height:16px;">
                          <span t-esc="o.company_id.street"/> <span t-esc="o.company_id.street2"/>
                        </p>
                        <p style="font-size:13px; margin:0; line-height:16px;">
                          TEL: <span t-esc="o.company_id.phone"/>
                        </p>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>

              <!-- Bill To & PO Info -->
              <table style="width:100%; border:1px solid rgba(0, 0, 0, 0.5); border-collapse: collapse; margin-top:-1px; font-size: 10px;">
                <tr>
                  <td style="width:50%; border-right:1px solid rgba(0, 0, 0, 0.5); vertical-align:top; padding:5px;">
                    <strong>BILL TO</strong><br/>
                    <span t-esc="o.company_id.name"/><br/>
                    <span t-esc="o.company_id.partner_id.street"/> <span t-esc="o.company_id.partner_id.street2"/><br/>
                    <span t-esc="o.company_id.partner_id.city"/> <span t-esc="o.company_id.partner_id.country_id.name"/><br/>
                    TEL: <span t-esc="o.company_id.phone"/><br/>
                    TAX CODE: <span t-esc="o.company_id.vat"/>
                  </td>
                  <td style="width:50%; vertical-align:top; padding:5px;">
                    <strong>P/O INFORMATION</strong>
                    <table style="width:100%; margin-top:5px; border:0px solid transparent; border-collapse:collapse;">
                      <tr>
                        <td style="border:0px solid transparent;">Prg.name</td>
                        <td style="border:0px solid transparent;">
                          <span t-esc="o.order_id.name or ''"/>
                        </td>
                      </tr>
                      <tr>
                        <td style="width:20%; border:0px solid transparent;">P/O Number</td>
                        <td style="border:0px solid transparent;">
                          <span t-esc="o.name"/>
                        </td>
                      </tr>
                      <tr>
                        <td style="border:0px solid transparent;">Supplier</td>
                        <td style="border:0px solid transparent;">
                          <span t-esc="o.supplier.name_supplier"/>
                        </td>
                      </tr>
                      <tr>
                        <td style="border:0px solid transparent;">Issue Date</td>
                        <td style="border:0px solid transparent;">
                          <span t-esc="o.date_create.strftime('%d/%m/%Y') if o.date_create else ''"/>
                        </td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>

              <!-- Chi tiết vật tư -->
              <table class="table table-sm"
                    style="width:100%; border:1px solid rgba(0, 0, 0, 0.5); border-collapse: collapse; margin-top:10px;">
                <thead>
                  <tr style="background-color:#f2f2f2; border:1px solid rgba(0, 0, 0, 0.5); font-size:9px; text-align:left; line-height:18px; height:25px;">
                    <th style="border:none; padding:8px 4px;">Mtr Code</th>
                    <th style="border:none; padding:8px 4px;">Mtr Name</th>
                    <th style="border:none; padding:8px 4px;">Dimension</th>
                    <th style="border:none; padding:8px 4px;">Rate</th>
                    <th style="border:none; padding:8px 4px;">Color</th>
                    <th style="border:none; padding:8px 4px;">Qty</th>
                    <th style="border:none; padding:8px 4px;">Unit Price</th>
                    <th style="border:none; padding:8px 4px;">Total</th>
                  </tr>
                </thead>
                <tbody style="font-size:8px; line-height:16px;">
                  <tr t-foreach="o.invoice_line_ids" t-as="line" style="height:22px; text-align:left;">
                    <td style="border:none; font-weight:bold; padding:6px 4px;"><span t-esc="line.mtr_code"/></td>
                    <td style="border:none; padding:6px 4px;"><span t-esc="line.mtr_name"/></td>
                    <td style="border:none; padding:6px 4px;"><span t-esc="line.dimension"/></td>
                    <td style="border:none; padding:6px 4px;"><span t-esc="line.rate"/></td>
                    <td style="border:none; padding:6px 4px;"><span t-esc="line.color_name"/></td>
                    <td style=" border:none; padding:6px 4px;">
                      <span t-esc="'{:.3f}'.format(line.act_qty)"/>
                    </td>
                    <td style=" border:none; padding:6px 4px;">
                      <span t-esc="'{:.3f}'.format(line.price)"/>
                    </td>
                    <td style="border:none; padding:6px 4px;">
                      <span t-esc="'{:.3f}'.format(line.act_qty * line.price)"/>
                    </td>
                  </tr>
                </tbody>
              </table>


              <!-- Tổng cộng -->
              <p style="text-align:right; margin-top:10px; font-size:13px;">
                <strong>Total Amount: </strong>
                <span t-esc="'{:.3f}'.format(sum(line.act_qty * line.price for line in o.invoice_line_ids))"/>
              </p>

              <!-- Điều khoản -->
              <div style="margin-top:30px; font-size:11px; line-height:1.3;">
                <t t-raw="o.terms_conditions or ''"/>
              </div>

              <!-- Footer -->
              <div class="footer">
                <div style="width:100%; text-align:left; font-size:12px; border-top:1px solid #000; padding-top:5px;">
                  P/O#: <span t-esc="o.name"/> - Page <span class="page"/> / <span class="topage"/>
                </div>
              </div>
            </div>
          </t>
        </t>
      </t>
    </template>
</odoo>